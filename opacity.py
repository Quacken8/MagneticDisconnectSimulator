#!/usr/bin/env python3
"""
interpolates opacity from a table generated by MESA, in particular the "MESA modules outside MESA" thingy
"""

import numpy as np
import constants as c

pathToOpacityTable = "externalData/kappasFromMESA"

logTs, logRhos, kappas = np.loadtxt(pathToOpacityTable, skiprows=1, usecols=(1,2,3)).T

#TODO - maybe unnecessary? maybe working in logs will be better?
# convert to straight variables
Ts = np.power(10, logTs)
Rhos = np.power(10, logRhos)

# convert to SI from cgs
Rhos *= c.gram/(c.cm**3)
kappas  *= c.cm**2/c.gram




def main():
    """debugging function for this file"""
    import matplotlib.pyplot as plt
    from mpl_toolkits import mplot3d

    fig = plt.figure()
    ax = plt.axes(projection='3d')
    ax.scatter(Ts, Rhos, kappas)
    # ax.scatter(np.log10(Ts), np.log10(Rhos), np.log10(kappas))
    ax.set_xlabel("Ts [K]")
    ax.set_ylabel("Rhos [kg/m^3]")
    ax.set_zlabel("Kappas [m^2/kg]")
    
    plt.show()


if __name__ == "__main__":
    main()